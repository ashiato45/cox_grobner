\label{sec:消去理論}
\subsection{消去および拡張定理}
\label{sub:消去および拡張定理}
グレブナ基底をlex順序で計算すると、変数の消去が起こることをみた。このことを示す。
そのために、「消去イデアル」を定義する。
$k[x_1,\dots,x_n]$のイデアル$I$について、「$I$の$l$次の消去イデアル$I_l$」を
$I_l \defeq I \cap k[x_{l+1},\dots,x_n]$と定める。これが\warn{$k[x_1,\dots,x_n]$の}イデアルになっていることを示す必要はある。
\begin{myproof}
  $I$は$k[x_1,\dots,x_n]$のイデアルであり、$k[x_{l+1},\dots,x_n]$は$k[x_{l+1},\dots,x_n]$のイデアルなので、イデアルの交わりがイデアルになることは使えない。個別にイデアルの条件を示す必要がある。
  \begin{itemize}
    \item 和で閉じる:
    $f, g\in I_l$とする。$f,g \in I$なので、$f+g \in I$となる。
    また、$f,g \in k[x_{l+1},\dots,x_n]$なので、$f+g \in k[x_{l+1},\dots,x_n]$となっている。よって、$f+g \in (I\cap k[x_{l+1},\dots,x_n]) = I_l$となっている。
    \item 積で飲み込む:$f \in I_l$とし、$g\in k[x_{l+1},\dots,x_n]$とする。
    $gf \in I_l$であることを示す。$f\in k[x_{l+1},\dots,x_n]$なので、
    $gf \in k[x_{l+1},\dots,x_n]$となっている。また、$I$がイデアルであり$f\in I$
    なので、$gf\in I$となっている。よって、$gf\in I_l$となっている。
  \end{itemize}
\end{myproof}
さらに、$l$次の消去イデアル$I_{l}$の$1$次の消去イデアル$(I_l)_1$は$I$の$l+1$次の消去イデアル$I_{l+1}$になっている:$(I_l)_1 = I_{l+1}$である。
\begin{myproof}
  $I_l = I \cap k[x_{l+1},\dots,x_n]$であり、
  $I_{l+1} = I\cap k[x_{l+2},\dots,x_n]$であり、
  $(I_l)_1 = I_l \cap k[x_{l+2},\dots,x_n]$である。よって、
  \begin{align}
    (I_l)_1
    &=
    I_l \cap k[x_{l+2},\dots,x_n]\\
    &=
    (I\cap k[x_{l+1},\dots,x_n]) \cap k[x_{l+2},\dots,x_n]\\
    &=
    I \cap k[x_{l+1},\dots,x_n]\\
    &=
    I_l.
  \end{align}
  示された。
\end{myproof}
つまり、高次の消去イデアルを考えたいときには、1次ずつ消去イデアルを計算すればよいことがわかった。

消去イデアルはその定義から、イデアル$I$のうち文字を消したもののあつまりであり、
$G$を$I$の基底とするなら、この$G$をたしひきかけ算して文字を消したもののあつまりとなっている。
$\var(I)$を考えると、これに属する点は$I$の式を0にしなくてはならず、特に
$I_l$の式を0にしなくてはならない。これは、$\var(I)$に点が属するには
$k[x_{l+1},\dots,x_n]$のなかではどうでなければならないかという必要条件を与える。
$I_l$の式を0にするときを考えるには$I_l$の基底がわかっていれば必要十分なので、
$I_l$の基底を求める方法を知りたいが、これにはGroebner基底が便利である。
次のことが言える。これを消去定理とよぶ。
「$G$を$I\subset k[x_1,\dots,x_n]$のlex順序でのGroebner基底とすると、
$G\cap k[x_{l+1},\dots,x_n]$は$I_l$のGroebner基底となる。」
\begin{myproof}
  $G\cap k[x_{l+1},\dots,x_n] \subset I_l$なので、
  $\gen{\LT(G\cap k[x_{l+1},\dots,x_n])} = \gen{\LT(I_l)}$
  となることを示せばよい。この$\subset$は、$G\cap k[x_{l+1},\dots,x_n]\subset I_l$は自明なので、生成元$\LT(I_l)$が$\gen{\LT(G\cap k[x_{l+1},\dots,x_n])}$に包まれることを示せばよい。$f\in I$なので、$\LT(f)\in \LT(I) \subset \gen{\LT(I)} = \gen{\LT(g_1),\dots,\LT(g_s)}$となっていて、
  $\LT(g_i) | \LT(f)$となる$i$が存在する。示したいのは
  $\LT(f)$が$\LT(G\cap k[x_{l+1},\dots,x_n])$のどれかで割り切れることであり、$\LT(G)$
  である$\LT(g_i)$で割り切れることは示したので、あとは$g_i \in k[x_{l+1},\dots,x_n]$を示せばよい。

  $f\in k[x_{l+1},\dots,x_n]$なので、
  $\LT(f) \in k[x_{l+1},\dots,x_n]$である。多項式順序の性質から、
  $\LT(g_i) \le \LT(f)$であり、いまはlex順序を採用しているので、
  $\LT(g_i) \in k[x_{l+1},\dots,x_n]$となる。さらにlex順序を採用しているので、
  $g_i \in k[x_{l+1},\dots,x_n]$となり、$g_i \in G \cap k[x_{l+1},\dots,x_n]$となる。
  よって、$g_i \in G\cap k[x_{l+1},\dots,x_n]$であり、
  $\LT(g_i) | \LT(f)$であり、$\LT(f)\in \gen{\LT(G\cap k[x_{l+1},\dots,x_n])}$となっている。

\end{myproof}
これで消去のほうは議論できた。あとは後退代入に相当するところを考える。

文字を消した結果の式を満たすことは、多様体に点が属することの必要条件でしかない。
それを満たす点のことを部分解という。つまり、「$(a_{l+1},\dots,a_n) \in k[x_{l+1},\dots,x_n]$が$\var(I)$の部分解である」とは、
「$(a_{l+1},\dots,a_n) \in \var(I_l)$となる」ことである。
したがって、多様体に属するように整合性が取れるように他の点が取れるかどうかは分からない。そのような拡張ができるための十分条件として、次の拡張定理がある。
「
体は$k=\C$で考えることにする。
$(a_{2},\dots,a_n)\in \var(I_1)$を部分解とする。
$I$のGroebner基底を$G$とする。
$k[x_1,\dots,x_n]$の多項式について、その多項式を$(\C[x_2,\dots,x_n])[x_1]$の元、すなわち$x_1$だけを不定元とみなした多項式とみなしたときの最高次の係数を$\LC'$とよぶことにする。ただし、$\LC'(0)$は考えないことにする。この条件のもとで、
\begin{align}
  (a_2,\dots,a_n) \notin \var(\LC'(G))
  \implies
  (a_1,a_2,\dots,a_n) \in \var(I)となるa_1(\in \C) が存在する
\end{align}
となる。証明は後の節でやる。
先に、$(I_l)_1 = I_{l+1}$であることは示したので、必要なら繰り返し使えばよい。

ここで、2つの特徴的な条件がある。
\begin{itemize}
  \item 体を$\C$にしていること:$x^2 = z,\, x^2 = y$を$\R$上で考えて先の定義をナイーブに適用すると、$x$を消去した$y=z$上、つまり$(a,a)$は、
  $\var(\LC'(x^2-z),\LC'(x^2-y))=\var(1,1)=\emptyset$に入らない限り、
  つまりいつでも拡張できるということになるが、実際は$a\ge0 $のときだけ拡張できる。
  \item $(a_2,\dots,a_n) \notin \var(\LC'(G))$としていること:
  $xy=1,\, xz=1$を考える。
  \insertcalc{calc_3_1.tex}
  という計算で、このGroebner基底が$y-z,\, xz-1$である。よって、$I_1 = \gen{y-z}$である。よって、$\var(I_1) = \set{(a,a); a\in \C}$となる。
  よって、これをナイーブに拡張すると、$(1/a,a,a)$となる。

  ここで先の条件を考えてみる。
  $\LC'(xz-1)=z$なので、拡張できるための十分条件として$(a,a) \notin \var(z)$が得られる。つまり、拡張できないかもしれない場合というのは、$(a,a) \in \var(z)$になる。このときというのは、$a=0$のときである。このときは実際、$1/a$が考えられない。
  また図を考えて、$y=z,\, xz=1$というときを考える。これは、
  平面$y=z$と双曲線$xz=1$を$y$方向に延ばしたやつの共有点全体だが、
  この点のうち$z=0$となっているものはあきらかに存在しない。

\end{itemize}

$\LC'(g_1),\dots,\LC'(g_s)$のうち定数があったときはあきらかに$\var(\LC'(g_1),\dots,\LC'(g_s)) = \emptyset$となるので、
部分解全体が拡張できることが保証される。つまり、系として「
体は$k=\C$とする。部分解$(a_2,\dots,a_n)\in \var(I_1)$
があったとする。さらに、$G$を$I$のGroebner基底とし、
$\LC'(G)$のうち(当然非0の)定数があったとすると、
部分解$(a_2,\dots,a_n)$は常に$(a_1,\dots,a_n) \in \var(I)$に
拡張できる。」が得られる。仮に$g_1,\dots,g_s$に定数があったとすると、元の
$\gen{I}$が全体集合になり、$\var(I)$は空集合になる。このときは、拡張もなにもなくなってしまうので自明に正しい。また、仮に$g_1,\dots,g_s$に0があったとすると、
そのような0は外しておけばよいので考える必要がない。このときは$\LC'$を考えることができなくなってしまう。

\subsection{消去の幾何}
\label{sub:消去の幾何}
頭$l$個落とす写像$\pi_l\colon \C^n \to \C^{n-l}$を射影写像(projection map)という。
すると、消去イデアルとについて、次の関係がある。「
$f_\bullet \in k[x_1,\dots,x_n]$とする。
\begin{align}
  \pi_l(\var(f_1,\dots,f_s)) \subset \var(\gen{f_1,\dots,f_s}_l)
\end{align}
となる。言い換えるなら、多様体の($l$次の)射影は($l$次の)部分解に包まれる。
」
\begin{myproof}
$(a_1,\dots,a_n)\in \var(f_1,\dots,f_s)$とする。
$f_\bullet(a_1,\dots,a_n) = 0$となっている。
$\pi_l(a_1,\dots,a_n) = (a_{l+1},\dots,a_n)$である。

一般に、$f\in k[x_{l+1},\dots,x_n]$のとき、これを$f\in k[x_1,\dots,x_n]$とみなすと、
$f(\xi_1,\dots,\xi_n)$は$\xi_1,\dots,\xi_{l}$の値に依存せず、$\xi_{l+1},\dots,\xi_n$の値のみによって定まる。これは、$f\in k[x_1,\dots,x_n]$ではあるが、
$k[x_{l+1},\dots,x_n]$からの埋め込みだったので、式のなかに$x_1,\dots,x_n$の文字があらわれず、これらに対応する値$\xi_1,\dots,\xi_{l}$に値が依存しないからである。
よって、$f(\pi(\xi_{1},\dots,\xi_{n}))$と$\pi_l$による同値類で定めれば、これはwell-definedである。

$f\in \gen{f_1,\dots,f_s}_l$とする。
$f\in k[x_{l+1},\dots,x_n]$なので、先の考察より$f$のとる値は$\pi_l$の同値類で定ま
り、
\begin{align}
  f(a_{l+1},\dots,a_n) = f(\pi_l(a_1,\dots,a_n)) = f(0,\dots,0,a_{l+1},\dots,a_n)
\end{align}
である。また、$f\in \gen{f_1,\dots,f_s}$なので、$f = \sum_i h_i f_i$となる
$h_\bullet \in k[x_1,\dots,x_n]$が存在し、
\begin{align}
  f(a_{l+1},\dots,a_n)
  &\desceq{頭$l$個はなんでもいい(well-defined)}
  f(a_1,\dots,a_n)\\
  &=
  \sum_{i=1}^s h_i(a_1,\dots,a_n) \ub{f_i(a_1,\dots,a_n)}_{=0,\,はじめの設定}\\
  &=
  0.
\end{align}
\end{myproof}
言い換えるなら、多様体の射影は、部分解のうち拡張できるもの全体に一致する(そりゃそうだ、射影が部分解をはみ出ることがないというほうが重要情報っぽい。)。
例えば、$(y=z,xy=1)$を考えると、これの射影$\pi_1(\var(y-z,xy-1))$は$\set{(a,a); a\neq 0}$であり、消去イデアルのなす多様体は$\var(\gen{y-z})$になって、$\set{(a,a)}$になる。

ただし、多様体の射影がかならず多様体になるとは限らない。実際先の例だと、
$\pi_1(\var(y-z,xy-1))= \set{(a,a); a\neq 0}$であり、これは多様体でない。
この状況を考えるために、次の分解を用意しておく。
「$f_1,\dots,f_s \in k[x_1,\dots,x_n]$について、
\begin{align}
  \var(f_1,\dots,f_s)
  =
  \pi_1(\var(f_1,\dots,f_s))
  \cup
  (\var(f_1,\dots,f_s) \cap \var(\LC'(f_1),\dots,\LC'(f_s))).
\end{align}
となる。」
\begin{myproof}
  \begin{itemize}
    \item $\supset$:
    $a=(a_1,\dots,a_n)$とする。$a\in \pi_1(\var(f_1,\dots,f_s))$のときは、
    先の「多様体の射影は部分解に含まれる」より、$a\in \var(f_1,\dots,f_s)$となる。
    $a\in \var(f_1,\dots,f_s)\cap \var(\LC'(f_1),\dots,\LC'(f_s))$
    のときは自明に$a\in \var(f_1,\dots,f_s)$となる。
    \item $\subset$:
    $a\in \var(f_1,\dots,f_s)$とする。
    $a\notin \var(f_1,\dots,f_s)\cap \var(\LC'(f_1),\dots,\LC'(f_s))$であるとする。
    このときは、$a\in \var(f_1,\dots,f_s)$なので、$a\notin \var(\LC'(f_1),\dots,\LC'(f_s))$なので、先の拡張定理により$a\in \pi_1(f_1,\dots,f_s)$となる。
  \end{itemize}
\end{myproof}

正確に多様体の射影と部分解との関係を記述するものとして、閉包定理がある:「
$f_1,\dots,f_s \in k[x_1,\dots,x_n]$として、
\begin{enumerate}[label=(\alph*)]
  \item $\pi_l(\var(f_1,\dots,f_s))$を包む最小の多様体は$\var(\gen{f_1,\dots,f_s}_l)$である。
  \item $\var(f_1,\dots,f_s)\neq \emptyset$とする。
  $\pi_l(\var(f_1,\dots,f_s))$は、多様体$\var(\gen{f_1,\dots,f_s}_l)$から、これに真に包まれる多様体$W$を削ったものを包む:
  \begin{align}
    \Exists{W(:多様体,\, \subsetneq \var(\gen{f_1,\dots,f_s}_l))} \ub{\var(\gen{f_1,\dots,f_s}_l)-W}_{\neq \emptyset} \subset \pi_l(\var(f_1,\dots,f_s))
  \end{align}
  となる。
\end{enumerate}
」
\begin{myproof}
  (b)の$l=1$のときだけを証明する。$\var(f_1,\dots,f_s)$に関して、
  条件を満たす、この多様体に真に含まれる多様体を探す。
  \begin{algorithm}[H]
    \caption{削る多様体を探す}
    \begin{algorithmic}[1]
      \STATE{$list \Leftarrow [f_1,\dots,f_s]$}
      \STATE{$stop \Leftarrow false$}
      \WHILE{$stop = false$}
      \IF{$list \subset k[x_2,\dots,x_n]$}
        \STATE{$stop \Leftarrow true$}
        \STATE{$W \Leftarrow \emptyset$}
      \ELSE{}
        \STATE{$W \Leftarrow \var(\gen{list}_1)\cap \var(\LC'(list))$}
        \IF{$\var(\gen{list}_1)- W \neq \emptyset$}
          \STATE{$stop \Leftarrow true$}
        \ELSE{}
          \STATE{$list \Leftarrow [x\mapsto x-\LT'(x)](list) + \LC'(list)$}
        \ENDIF{}
      \ENDIF{}
      \ENDWHILE{}
    \end{algorithmic}
  \end{algorithm}
  ただし、$\LT'$は、$k[x_2,\dots,x_n][x_1]$とみなしたときの先頭項とする。
  \begin{itemize}
    \item アルゴリズムは停止する:
    L.3の停止条件から、L.3～L.15のループが1回実行されるごとに、必ず
    L.12が実行される。この行について、
    $[x\mapsto x-\LT'(x)](list)$は、$k[x_2,\dots,x_n][x_1]$での先頭項を消しており、
    $\LC'(list)\subset k[x_2,\dots,x_n]$なので、$list$の最高の($k[x_2,\dots,x_n][x_1]$での)次数は、$0$より大きければ真に減少する。

    このことから、$list$の次数はあるところで
    $0$に到達する。つまり、$list$の元がどれも$k[x_2,\dots,x_n]$に属することになる。
    すると、その次のループのなかで、L.4の条件が真となり、L.5で$stop = true$となるので、L.4の停止条件を満たすようになり、アルゴリズムは停止する。
    \item $\var(list)$は変わらない:
    $list$が変化するのはL.12でのみであり、このときには、
    \begin{enumerate}[label=(\alph*)]
      \item  $list_b \not\subset k[x_2,\dots,x_n]$
      \item $W_a = \var(\gen{list_b}_1)\cap \var(\LC'(list_b))$
      \item $\var(\gen{list_b}_1) - W_a = \emptyset$
      \item $list_a = [x\mapsto x-\LT'(x)](list_b) + \LC'(list_b)$
    \end{enumerate}
    となっている。

    まず、
    $\var(list_b) = \var(list_b + \LC'(list_b))$を示す。
    (b),(c)
    より、
    \begin{align}
      \var(\gen{list_b}_1) \subset W_a =
      \var(\gen{list_b}_1) \cap \var(\LC'(list_b))
      \subset
      \var(\LC'(list_b))
    \end{align}
    $\gen{list_b} \supset \gen{list_b}_1$なので、
    $\var(list_b) \subset \var(\gen{list_b}_1)$である。よって、
    \begin{align}
      \var(list_b) \subset \var(\LC'(list_b))
    \end{align}
    である。よって、
    \begin{align}
      \var(list_b) = \var(\LC'(list_b))\cap \var(list_b) =
      \var(\LC'(list_b) + list_b)
    \end{align}
    である。

    そして、
    \begin{align}
      \gen{\LC'(list_b) + list_b} =
      \gen{\LC'(list_b) + ([x\mapsto x-\LT'(x)](list_b)) }
      = \gen{list_a}
    \end{align}
    なので、
    \begin{align}
      \var(list_a) = \var(\LC'(list_b) + list_b)
      =
      \var(list_b)
    \end{align}
    である。

    \item $\pi_1(\var(list))$は変わらない:
    $\var(list)$が変わらないことから直ちに従う。
    \item $\var(\gen{list}_1)$は変わらない:
    $list$が変化する、すなわちL.12が実行されるときを考えればよく、
    「$\var(list)$は変わらない」の状況と同じとしてよい。
    閉包定理より、$\var(\gen{list_a}_1)$は$\pi_1(\var(list_a))$を包む最小の多様体である。また、$\var(list_b)$は$\pi_1(\var(list_b))$を包む最小の多様体である。しかし、先に示したことより、「$\pi_1(\var(list))$は変わらない」ので、
    $\pi_1(\var(list_b))=\pi_1(\var(list_a))$である。よって、
    $\var(\gen{list_a}_1)$も$\var(\gen{list_b}_1)$も同じ多様体
    $\pi_1(\var(list_b))=\pi_1(\var(list_a))$を包む最小の多様体なので、
    \begin{align}
      \var(\gen{list_a}_1) = \var(\gen{list_b}_1)
    \end{align}
    である。
    \item 停止時点で、$W\subsetneq \var(\gen{f_1,\dots,f_s}_1)$となり、$W$は多様体である。
    \begin{itemize}
      \item 停止直前に実行されたのがL.5である:
      このとき$W=\emptyset$なのであきらか。
      \item 停止直前に実行されたのがL.10である:
      このとき$W=\var(\gen{list}_1) \cap \var(\LC'(list))$なので、多様体ではある。

      さらに、$W$のこの式より、$W \subset \var(\gen{list}_1)$であることも保証される。

      最後に、$W\neq \var(\gen{list}_1)$であることを示せばよいが、そうだとするとL.9の条件が通過できず矛盾する。
    \end{itemize}
    \item 停止時点で、$W$は$\var(\gen{f_1,\dots,f_s}_1)-W \subset \pi_1(\var(f_1,\dots,f_s))$となる。
    \begin{itemize}
      \item 停止直前に実行されたのがL.5であるとき:
      $list\subset k[x_2,\dots,x_n]$となっている。
      よって、$\gen{list}_1 = \gen{list}$となる。
      よって、$\var(list)$は$x_1$を使わずに定義されていることわかり、
      どの部分解$\var(\gen{list}_1)$も、拡張できること、すなわち
      $\var(\gen{list}_1) = \pi_1(\gen{list})$がわかる。
      これまで示してきた不変より、
      \begin{align}
        \var(\gen{f_1,\dots,f_s}_1)-W
        &=
        \var(\gen{f_1,\dots,f_s}_1)-W\\
        &=
        \var(\gen{list}_1)-W\\
        &=
        \var(\gen{list}_1)\\
        &=
        \pi_1(\var(list))\\
        &=
        \pi_1(\var(f_1,\dots,f_s)).
      \end{align}
      また、$W$はあきらかに$\var(\gen{f_1,\dots,f_s}_1)$に含まれる多様体であり、満たされた。
      \item 停止直前がL.10のとき:
      $list$に関して、部分解の分解を考えると、$W= \var(\gen{list}_1) \cap \var(\LC'(list))$となるから、
      \begin{align}
        \var(\gen{list}_1)
        =
        \pi_1(\var(list)) \cup W
      \end{align}
      となる。よって、$\var(\gen{list}_1)-W\subset \pi_1(\var(list))$となる。
      これまで示してきたことより、
      \begin{align}
        \var(\gen{f_1,\dots,f_s}_1)-W
        &=
        \var(\gen{list}_1)-W\\
        &\subset
        \pi_1(\var(list))\\
        &=
        \pi_1(\var(f_1,\dots,f_s)).
      \end{align}

    \end{itemize}
  \end{itemize}
\end{myproof}
(a)は射影を多様体で上から抑え、(b)は多様体の差で下から抑えている。

この定理だと$\pi_1(\var(f_1,\dots,f_s))$が正確にどういう形をしているかは分からない。
実は
\begin{align}
  \pi_1(\var(f_1,\dots,f_s)) = \bigcup_{i=1}^t (A_i - B_i)
\end{align}
となる多様体$A_i,B_i$が存在する、つまり多様体の射影は多様体の差の和で書けることがわかり、このような(？)集合を構成可能という。あとでやる。

この節で$\pi$の記号を整備して、先の節での系を幾何学的に言い直すことができる。
すなわち:「$\var(g_1,\dots,g_s)$について、$\LC'(g_1),\dots,\LC'(g_s)$のうちで
定数(当然非0)があるならば、$\pi_1(\var(g_1,\dots,g_s)) = \var(\gen{g_1,\dots,g_s}_1)$となる。」$g_1,\dots,g_s$のうち0があるような場面は、その0を外しておけるので考える必要がない。このときは$\LC'$を考えることができなくなってしまう。また、そもそも非0の定数があったときには、多様体は空集合をあらわすようになる。このときは射影しても空でありやはり成立している。

\subsection{陰関数表示化}
\label{sub:陰関数表示化}
パラメタ表示された図形、つまり関数の像を陰関数表示することを考える。
ここで、陰関数表示とは、パラメタ表示された図形を包む最小のアフィン多様体を求めることである。図形を包む最小のアフィン多様体ということで、先の閉包定理を利用したいが、そのためにパラメタ表示された図形というのを何かのアフィン多様体の射影として表現できると便利である。そこで、グラフを考える。

$k^n$中で多項式で表示された図形を考える。この図形は、$F=(f_1,\dots,f_n)\colon k^m \to k^n$であらわされており、$f_\bullet \in k[t_1,\dots,t_m]$とする。
グラフへの埋め込み$i\colon k^m \to k^{m+n}$を、
\begin{align}
  i(t_1,\dots,t_m) = (t_1,\dots,t_m)\oplus F(t_1,\dots,t_m)
\end{align}
と定義する。この$i(k^m)$は$k[t_1,\dots,t_m,x_1,\dots,x_n]$のアフィン多様体であって、
\begin{align}
  i(k^n) = \var(f_1-x_1,\dots,f_n-x_n)
\end{align}
である。なぜならグラフは、$t_\bullet$のスロットには$t_\bullet$がそのまま入っていてほしいし、$x_\bullet$のスロットには$f(t_1,\dots,t_m)$が入っていてほしいからである。$x_\bullet$が$F$の値域側の文字であることには注意する。ただしここで、$x_\bullet$は
\begin{align}
  x_i(t_1,\dots,t_m,x_1,\dots,x_n) = x_i \quad (i=1,\dots,n)
\end{align}
という関数$x_\bullet \colon k^{m+n} \to k$であり、
$f_\bullet$は$f_\bullet \in k[t_1,\dots,t_m]$でもあるが、
\begin{align}
  f_i(t_1,\dots,t_m,x_1,\dots,x_n) = f_i(t_1,\dots,t_m)
\end{align}
とみなしている。
そして、グラフの射影はいままで通り、$\pi_m$を考える。すると、
\begin{align}
  \pi_m(t_1,\dots,t_m,x_1,\dots,x_n) = (x_1,\dots,x_n)
\end{align}
であるから、$F=\pi_m\circ i$となった。よって、$F(k^n) = \pi_m\circ i(k^n)=\pi_m(i(k^n))$となり、パラメタ付けされた図形$F(k^n)$は、
アフィン多様体$\var(x_1-f_1,\dots,x_n-f_n)=i(k^n)$の射影
$\pi_m(i(k^n))$としてあらわせた。これで閉包定理を使う準備ができた。

多項式でパラメタ表示された図形を陰関数表示する手法として、次がある:「
無限体$k$上の図形の多項式によるパラメタ表示$F=(f_1,\dots,f_n)\colon k^m \to k^n$について、$F(k^m)$を包む最小のアフィン多様体は$\var(\gen{\ub{x_1-f_1}_{k[t_1,\dots,t_m,x_1,\dots,x_n]},\dots,x_n-f_n}_m)$
である。」
\begin{myproof}
$k$が代数的閉体であるときには、$F(k^m) = \pi_m(i(k^m)) = \pi_m(\var{\gen{f_1-x_1,\dots,f_n-x_n}})$を包む最小の多様体を考えればよいが、
閉包定理よりこれは$\var(\gen{f_1-x_1,\dots,f_n-x_n}_m)$である。

$k$を包む代数的閉体$K$が存在するので、これをかんがえる(体論)。
以降、係数を$k$とするイデアルを$\gen{\bullet}_k$と書き、多様体を$\var_k(\bullet)$と書く。また、$K$についても同様とする。
$F(k^n)$を包む最小の多様体を$Z_k$とする。このとき、$\pi_m(i(k^n)) \subset Z_k$であることを示そう。
\end{myproof}

やりなおし。$I=\gen{x_1-f_1,\dots,x_n-f_n}$としてある。
\begin{myproof}
  $V=\var(I)$とする。

  まず、$\C$上で考える。
  パラメタで表示された図形$F(k^m)$は、先のグラフの利用により
  $\pi_m(i(k^m))=\pi_m(V)$と表示される。$V$はアフィン多様体で、
  $\pi_m(V)$はその射影なので、閉包定理によりこれを包む最小の多様体は
  $\var(I_m)$である。$\C$のときは証明おわり。

  $k\subset \C$上で考える。$k$は$\C$の1と$+$を持つので、
  無限体である。
  $\C$上の多様体と$k$上の多様体を区別するため、$\var_\C,\, \var_k$を考える。
  $V_k = \var_k(I),\, V_\C = \var_\C(I)$としてある。
  \begin{align}
    F(k^m) \desceq{グラフの射影} \pi_m(V_k) \descsubset{補題} \var_k(I_m).
  \end{align}
  これで$F(k^m)\subset \var_k(I_m)$は示された。あとは最小性を示せばよい。
  $F(k^m)$を包もうとすると一緒に$\var_k(I_m)$も包んでしまうことを示せばよい。
  $Z_k = \var_k(g_1,\dots,g_s) \subset k^n$を$F(k^m)$を包む多様体とする。
  各$i=1,\dots,s$について、$F(k^m)\subset Z_k$なので$g_i$は
  $F(k^m)$上消えてしまう。よって、$g_i\circ F$は$k^m$を消す。
  $g_i \in k[x_1,\dots,x_n]$であり、$F\in k[t_1,\dots,t_m]$なので、
  $g_i\circ F \in k[t_1,\dots,t_m]$であり、$g_i\circ F \in k[t_1,\dots,t_m]$
  である。
  $k$は無限体だと先に言ったので、$g_i\circ F$は多項式として0である。
  多項式として0なので、$(g_i\circ F)(\C^m) = 0$であり、
  $g_i$は$F(\C^m)$上で消える。よって、$F(\C^m) \subset Z_\C = \var_\C(g_1,\dots,g_s)$である。
  $\C$の場合の定理より、パラメタ表示$F(\C^m)$を包む最小の多様体は
  $\var_\C(I_m)$であるから、$\var_\C(I_m) \subset Z_\C$である。
  両方で$k^n$の結びをとって、
  \begin{align}
    \var_k(I_m)
    =
     \var_\C(I_m) \cap k^n
     \subset
     Z_\C \cap k^n
     =
     Z_k
  \end{align}
  である。これで、$F(k^m)$を含む多様体のうち最小のものは$\var_k(I_m)$であることが示された。

  一般の体については、その代数閉体を考えればよい。
\end{myproof}
登場人物:
\begin{itemize}
  \item $k$:無限体
  \item $F = (f_1,\dots,f_n)\colon k^m \to k^n$:図形のパラメタ。
  \item $I = \gen{x_1-f_1,\dots,x_n-f_n}$
  \item $V=\var(I) \subset k^{n+m}$、$F$のグラフ
  \item $V_k = \var_k(I)$:体$k$をとったときの$F$のグラフ($k$多様体)
  \item $V_\C = \var_\C(I)$:体$\C$をとったときの$F$のグラフ($\C$多様体)
  \item $Z_k$:$F(k^m)$を包む自由な多様体。
  \item $g_1,\dots,g_s \in k[t_1,\dots,t_m]$:$Z_k$を定義する自由な多項式。
  \item $Z_\C$:同じ$g_1,\dots,g_s$で定義される、$Z_k$に付随する多様体。$Z_k$より大きい。
\end{itemize}

次に有理パラメタ表示の陰関数表示を考える。
\begin{align}
  x_1 = \frac{f_1}{g_1},\dots,x_n=\frac{f_n}{g_n}
\end{align}
の陰関数表示を考える。
分母を処理するために、$g=g_1 \dots g_n$とし、パラメタ$y$を次のように導入し、
$k[y,t_1,\dots,t_m,x_1,\dots,x_n]$で考える。
「$g(x)$は0になる$\iff$ $g_1(x),\dots,g_n(x)$の1つ以上は0になる」
であり、「$g(x)$はnonzero$\iff$ $g_1(x),\dots,g_n(x)$はどれも0にならない」
となる。$W=\var(g)$とする。
\begin{align}
  J=\gen{g_1x_1-f_1,\dots,g_n x_n - f_n , 1-gy}
\end{align}
とする($1-gy$で$W$を避ける)。
\begin{align}
  j(t_1,\dots,t_m)=
  (\frac{1}{g(t_1,\dots,t_m)},
  t_1,\dots,t_m,
  \frac{f_1(t_1,\dots,t_m)}{g_1(t_1,\dots,t_m)},
  \dots,
  \frac{f_n(t_1,\dots,t_m)}{g_n(t_1,\dots,t_m)}).
\end{align}
こうしておくと、実は$j(k^m-W)=\var(J)$となる。
\begin{myproof}
  \begin{itemize}
    \item $\subset$:
    あきらか。実際、
    $(t_1,\dots,t_m) \in k^m-W$とする。
    \begin{align}
      j(t_1,\dots,t_m)=
      (\ub{\frac{1}{g(t_1,\dots,t_m)}}_{\Rightarrow y},t_1,\dots,t_m,
      \ub{\frac{f_1(t_1,\dots,t_m)}{g_1(t_1,\dots,t_m)}}_{\Rightarrow x_1},\dots, \ub{\frac{f_n(t_1,\dots,t_m)}{g_n(t_1,\dots,t_m)}}_{\Rightarrow x_n}).
    \end{align}
    これは$J$の生成元を考えれば、$\var(J)$に属する。
    \item $\supset$:
    $(y,t_1,\dots,t_m,x_1,\dots,x_n)\in \var(J)$とする。
    $yg(t_1,\dots,t_m)=1$となるので$g(t_1,\dots,t_m)$がnonzeroで、
    $g_1(t_1,\dots,t_m),\dots,g_n(t_1,\dots,t_m)$はどれもnonzeroになる。
    よって割り算が考えられて、
    $x_i = \frac{f_i(t_1,\dots,t_m)}{g_i(t_1,\dots,t_m)}$を考えられる。
    すると、$j(t_1,\dots,t_m)=(y,t_1,\dots,t_m,x_1,\dots,x_n)$となり、
    $(y,t_1,\dots,t_m,x_1,\dots,x_n)\in j(k^m-W)$となる。
  \end{itemize}
\end{myproof}
$F=\pi_{m+1}\circ j$なので、
\begin{align}
  F(k^m-W)=\pi_{m+1}(j(k^m-W))=\pi_{m+1}(\var(J))
\end{align}
となる。これで、パラメタ表示の図形をアフィン多様体の射影であらわせたので閉包定理が使える。有理陰関数表示化:「$k$を無限体とする。
$F\colon k^m - W \to k^n$を有理関数によるパラメタ付けとする。
$J$をイデアル
\begin{align}
    J=\gen{g_1x_1-f_1,\dots,g_nx_n-f_n,1-gy}\subset k[y,t_1,\dots,t_m,x_1,\dots,x_n]
\end{align}
とする。$g=g_1\dots g_n$とした。
$J_{m+1}=J\cap k[x_1,\dots,x_n]$を$(m+1)$次消去イデアルとする。このとき、
$\var(J_{m+1})$は$F(k^m-W)$を含む$k^n$の最小の多様体である。」
\begin{myproof}
  $k=\C$のときには$\pi_{m+1}(\var(J))=F(k^m-W)$と閉包定理よりあきらか。

  $k\subsetneq \C$とする。$k$は無限体である。
  $\C$上の多様体と$k$上の多様体を区別するため、$\var_\C,\var_k$を考える。
  $V_k = \var_k(J),\, V_\C = \var_\C(J)$とする。
  \begin{align}
    F(k^m-W) \desceq{さっきの} \pi_m(V_k)  \descsubset{射影が小さい補題} \var_k(J_{m+1}).
  \end{align}
  これで$F(k^m-W)\subset \var_k(J_{m+1})$は示された。
  あとは最小性を示せばよい。$Z_k = \var_k(h_1,\dots,h_s)\subset k^n$を
  $F(k^m-W)$を包む多様体とする。
  各$i=1,\dots,s$について、$F(k^m-W)\subset Z_k$なので、$h_i$は
  $F(k^m-W)$上消えてしまう。よって、$h_i\circ F$は$k^m-W$上消える。
  仮に$h_i\circ F$が0多項式でないとする。$g$は0多項式ではないので、
  $(h_i\circ F)\cdot g$は0多項式ではない。しかし、
  $h_i\circ F$は$k^m-W$上消え、$g$は$W$上消えるので、$(h_i\circ F)\cdot g$は
  $k^m$で消える。無限体上で0関数になる多項式は0多項式なので$(h_i \circ F)\cdot g$は
  0多項式である。これは矛盾であり、$h_i\circ F$は0多項式である。
  よって、$(h_i\circ F)(\C^m)=0$であり、$h_i$は$F(\C^m)$上で消える。
  よって、$F(\C^m)\subset Z_\C = \var_{\V}(I_m)\subset Z_\C$である。
  両方で$k^n$の結びをとって、
  \begin{align}
    \var_k(J_{m+1}) = \var_{\C}(J_{m+1})\cap k^n
    \subset
    \Z_\C \cap k^n = Z_k
  \end{align}
  である。これで、$F(k^m)$を含む多様体のうち最小のものは$\var_k(J_{m+1})$であることが示された。
\end{myproof}
